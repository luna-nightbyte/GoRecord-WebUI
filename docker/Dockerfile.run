FROM alpine:latest AS final

# Install yt-dlp and Python dependencies
RUN apk add --no-cache yt-dlp python3

WORKDIR /app

COPY --from=lunanightbyte/gorecord-base:latest /compiled/server ./server
RUN mkdir -p /app/internal/settings
COPY ./internal/settings/* /app/internal/settings
COPY ./internal/settings/db /app/internal/settings/db
# Expose the port the server listens on
EXPOSE 80

CMD ["./server"]
